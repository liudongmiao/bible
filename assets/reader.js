(function(){if(typeof android==="undefined"){android={setVerse:function(w){console.log("android.setVerse: "+w)},setCopyText:function(w){console.log("android.setCopyText: "+w)},setHighlighted:function(w){console.log("android.setHighlighted: "+w)},showAnnotation:function(w){console.log("android.showAnnotation: "+w)},showNote:function(w){console.log("android.showNote: "+w)}}}var a,s,p;function v(x){var w=[];x=x||document;function y(B,A,z,D){var C=B.querySelectorAll(z);Array.prototype.forEach.call(C,function(E){if(!D||b(E,D,false)){A.push(E)}})}y(x,w,".chapternum");y(x,w,"sup.versenum");if(w.length==0){y(x,w,"sup",s)}return w}function q(){var x,z,w=NaN,B;B=v();for(var A=0;A<B.length;A++){var y=Math.round(B[A].getBoundingClientRect().top);if(y>=0){if(isNaN(w)||Math.abs(w)>3*y){x=B[A]}else{x=B[A-1]}break}else{w=y}}if(x){android.setVerse(x.textContent.split("-")[0].trim())}}if(!String.prototype.endsWith){Object.defineProperty(String.prototype,"endsWith",{writable:false,enumerable:false,configurable:false,value:function(w){return this.indexOf(w,this.length-w.length)!==-1}})}function i(z){var B="",J="",F,x,w,E,I="",K=NaN;x=document.createElement("div");w=document.querySelectorAll(z);for(var A=0;A<w.length;A++){B+=" "+w.item(A).innerHTML}x.innerHTML=B;E=v(x);for(var A=0;A<E.length;A++){var G=NaN,y=NaN,D;if(b(E[A],"chapternum")){D="1"}else{D=E[A].textContent.trim().split("-")}G=parseInt(D[0].trim());if(isNaN(G)){continue}E[A].parentNode.removeChild(E[A]);if(D.length>1){y=parseInt(D[1].trim())}if(!y||isNaN(y)){y=G}for(var H=G;H<=y;++H){if(isNaN(K)){I+=H}else{if(H==K){}else{if(H-K==1){if(!I.endsWith("-")){I+="-"}}else{if(I.endsWith("-")){I+=K}I+=",";I+=H}}}K=H}}if(I.endsWith("-")&&!isNaN(K)){I+=K}function C(L){var M=x.querySelectorAll(L);Array.prototype.forEach.call(M,function(N){N.parentNode.removeChild(N)})}C(".notelink");C(".footnote");C(".crossreference");J=x.textContent.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"").trim();return{verse:I,text:J}}function u(){var w=i(".selected");if(w.text){var x=document.querySelectorAll(".highlight.selected").length;android.setCopyText(""+x+"\n"+w.verse+"\n"+w.text)}else{android.setCopyText("")}}function g(w){var x=w.className,y;if(b(w,"selected")){y=false}else{y=true}x.match(/\S+/g).forEach(function(C){if(s&&C.indexOf(s)!=-1){var B=document.getElementsByClassName(C);for(var A=B.length-1;A>-1;--A){var z=B.item(A);if(z.nodeName=="SUP"){continue}if(!y){o(z,"selected")}else{n(z,"selected")}}}});u()}function h(B){var x="",w,y,C;if(!B){return false}w=document.body.innerHTML;y=w.toLowerCase();C=B.toLowerCase();while(w.length>0){var A=B,z=y.indexOf(C);if(z<0){break}if(w.lastIndexOf(">",z)>=w.lastIndexOf("<",z)){A='<span class="selected">'+B+"</span>"}x+=w.substring(0,z)+A;w=w.substr(z+B.length);y=y.substr(z+B.length)}x+=w;document.body.innerHTML=x;return true}function k(){var z,B,x,A='<span class="icon-footnote"></span>',w='<span class="icon-crossreference"></span>';r();h(search);if(highlighted){d(highlighted)}if(selected){c(selected)}if(Object.prototype.toString.call(notes)=="[object Array]"){notes.forEach(function(C){addnote(C)})}m();z=document.querySelector("#pb-demo");if(z){z.style.display="block"}t('a[id*="!f."]',A);t('a[id*="!x."]',w);t("sup.footnote",A);t("sup.crossreference",w);if(verse_start>1){var y=j(verse_start);if(y.length>0){x=y.item(0);B=x.getAttribute("id");if(B){window.location.hash=x.getAttribute("id")}else{x.setAttribute("id","pb-start");window.setTimeout(function(){window.location.hash="pb-start"},100)}}}}function t(w,x){var y=document.querySelectorAll(w);Array.prototype.forEach.call(y,function(z){var A=z.getAttribute("value");if(A){if(x){z.innerHTML=A.replace(/^.*?(<a.*?>).*?(<\/a>).*$/g,"$1"+x+"$2")}else{z.innerHTML=A}}else{z.innerHTML=x}})}function f(z){var y;if(z==undefined){z="highlight"}else{z=z.trim()}y=document.getElementsByClassName(z);for(var x=y.length-1;x>-1;--x){var w=y.item(x);if(w.className.trim()==z&&w.childNodes.length==1&&w.firstChild.nodeType==3){w.parentNode.replaceChild(w.firstChild,w)}else{o(w,z)}}search="";document.normalize()}function m(){document.querySelector("#content").addEventListener("click",function(z){var x=z.target;while(x&&x.nodeName!="BODY"){if(x.nodeName=="IMG"){var w=x.getAttribute("data-note");if(w){z.preventDefault();android.showNote(w);return}}else{if(x.nodeName=="A"&&(b(x,"notelink")||(x.parentNode&&x.parentNode.nodeName=="SUP"))){var y=x.hash.replace("#","");if(y){z.preventDefault();android.showAnnotation(y);return}}else{if(x.nodeName=="SPAN"&&(b(x,"text")||b(x,s,false))){if(search){f("selected")}g(x);break}}}x=x.parentNode}})}function j(z){var w=s+p+z,D=document.getElementsByClassName(w);if(D.length){return D}if(w[0]=="v"){var C=["a","b","c"];for(var y in C){D=document.getElementsByClassName(w+C[y]);if(D.length){break}}}else{var A,x,B=new RegExp("(?:^|\\s)"+w+"-\\S+");if(!a){a=document.querySelectorAll(".text")}for(A=0;A<a.length;++A){x=a.item(A).className.match(B);if(x){break}}if(A!=a.length){D=document.getElementsByClassName(x[0])}}if(D.length||z<2){return D}else{return j(z-1)}}function e(x,w,A){var B;if(!x){return}B=j(x);for(var z=B.length-1;z>-1;--z){var y=B.item(z);if(y.nodeName=="SUP"){continue}if(w===false){o(y,A)}else{n(y,A)}}}function n(x,w){if(!x){}else{if(!x.className){x.className=w}else{if(!b(x,w)){x.className+=" "+w}}}}function b(z,y,w){var x;if(!z||!z.className){return false}else{if(w===false){x=new RegExp("(?:^|\\s)"+y)}else{x=new RegExp("(?:^|\\s)"+y+"(?!\\S)")}}return z.className.match(x)!=null}function o(y,x){if(!y||!y.className){}else{var w=new RegExp("(?:^|\\s)"+x+"(?!\\S)");if(y.className.match(w)){y.className=y.className.replace(w,"").trim()}}}function r(){if(s!=undefined&&p!=undefined){return}try{p="-";s=document.querySelector(".text").className.replace(/\s*text\s*/g,"").split(p).splice(0,2).join(p)}catch(w){}try{if(!s||s.indexOf(p)==-1){p="_";s=document.querySelector("sup").className.split(p).splice(0,2).join(p);if(!s||s.indexOf(p)==-1){s="";p=""}}}catch(w){}}function d(y,w,x){r();if(!s){return}if(x===undefined){x="highlight"}y.split(",").forEach(function(B){var C=B.split("-"),A=parseInt(C[0]);if(C.length==2){var z=parseInt(C[1]);for(;A<=z;++A){e(A,w,x)}}else{e(A,w,x)}});if(x=="highlight"){android.setHighlighted(i(".highlight").verse)}}function c(x,w){d(x,w,"selected")}function l(y,w){var A,B=j(y);if(!B.length){return}for(var z=0;z<B.length;++z){A=B.item(z);if(A.firstChild&&A.firstChild.nextSibling){if(w===false&&A.firstChild.nextSibling.nodeName=="IMG"){A.removeChild(A.firstChild.nextSibling)}else{if(w!==false&&A.firstChild.nextSibling.nodeName!="IMG"){var x=document.createElement("img");x.setAttribute("class","note");x.setAttribute("data-note",y);x.setAttribute("src","note.png");A.insertBefore(x,A.firstChild.nextSibling)}}return}}}window.addEventListener("load",k);window.getFirstVisibleVerse=q;window.highlight=d;window.select=c;window.addnote=l})();